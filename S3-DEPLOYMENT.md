# üöÄ –î–µ–ø–ª–æ–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∞–π—Ç–∞ –≤ AWS S3

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ S3 –¥–µ–ø–ª–æ—è

- ‚úÖ **–î–µ—à–µ–≤–æ:** ~$1-5/–º–µ—Å—è—Ü –∑–∞ —Ö–æ—Å—Ç–∏–Ω–≥
- ‚úÖ **–ë—ã—Å—Ç—Ä–æ:** —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ:** 99.99% –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ GitHub Actions
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ S3 –±–∞–∫–µ—Ç–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∫–µ—Ç–∞

1. **–í–æ–π–¥–∏—Ç–µ –≤ AWS Console**
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ S3**
3. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –±–∞–∫–µ—Ç:**
   - –ò–º—è: `your-blog-name` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º)
   - –†–µ–≥–∏–æ–Ω: –≤—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π –∫ –≤–∞—à–µ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞: –æ—Ç–∫–ª—é—á–∏—Ç–µ (–¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∞–π—Ç–∞)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∞–π—Ç–∞

1. **–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –±–∞–∫–µ—Ç**
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Properties ‚Üí Static website hosting**
3. **–í–∫–ª—é—á–∏—Ç–µ —Ö–æ—Å—Ç–∏–Ω–≥:**
   - Index document: `index.html`
   - Error document: `404.html`
4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ URL —Å–∞–π—Ç–∞** (–ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø–æ–∑–∂–µ)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Permissions**
2. **–û—Ç–∫–ª—é—á–∏—Ç–µ Block all public access**
3. **–û–±–Ω–æ–≤–∏—Ç–µ Bucket Policy:**

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadGetObject",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::your-bucket-name/*"
        }
    ]
}
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```json
[
    {
        "AllowedHeaders": ["*"],
        "AllowedMethods": ["GET"],
        "AllowedOrigins": ["*"],
        "ExposeHeaders": []
    }
]
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IAM –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ IAM ‚Üí Users**
2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –ò–º—è: `s3-deploy-user`
   - Access type: Programmatic access

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:DeleteObject",
                "s3:ListBucket"
            ],
            "Resource": [
                "arn:aws:s3:::your-bucket-name",
                "arn:aws:s3:::your-bucket-name/*"
            ]
        }
    ]
}
```

### 3. –ü—Ä–∏–≤—è–∑–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É** —Å JSON –≤—ã—à–µ
2. **–ü—Ä–∏–≤—è–∂–∏—Ç–µ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**
3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ Access Key ID –∏ Secret Access Key**

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CloudFront (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏–∏

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ CloudFront**
2. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—é:**
   - Origin Domain: –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à S3 –±–∞–∫–µ—Ç
   - Viewer Protocol Policy: Redirect HTTP to HTTPS
   - Default Root Object: `index.html`

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

- **Cache Policy:** CachingOptimized
- **Origin Request Policy:** CORS-S3Origin

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞

1. **–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω** –≤ Alternate Domain Names
2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –≤ ACM
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS** –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –Ω–∞ CloudFront

## –õ–æ–∫–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

```bash
cp env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# AWS S3 Configuration
AWS_ACCESS_KEY_ID=your_access_key_id
AWS_SECRET_ACCESS_KEY=your_secret_access_key
AWS_REGION=us-east-1
S3_BUCKET_NAME=your-bucket-name

# Site Configuration
SITE_URL=https://your-domain.com
BASE_URL=/
```

### 3. –¢–µ—Å—Ç–æ–≤—ã–π –¥–µ–ø–ª–æ–π

```bash
# –°–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π
npm run deploy:static

# –ò–ª–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
npm run build
npm run deploy:s3
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (Settings ‚Üí Secrets and variables ‚Üí Actions) –¥–æ–±–∞–≤—å—Ç–µ:

- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION`
- `S3_BUCKET_NAME`
- `SITE_URL`
- `BASE_URL`
- `OPENAI_API_KEY`
- `TELEGRAM_BOT_TOKEN`
- `ADMIN_TELEGRAM_ID`
- `UNSPLASH_ACCESS_KEY`
- `CLOUDFRONT_DISTRIBUTION_ID` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ CloudFront)

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

Workflow –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è:
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 9:00 UTC**
- **–ü—Ä–∏ push –≤ main –≤–µ—Ç–∫—É**
- **–í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ GitHub Actions**

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. CloudWatch Logs

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –¥–µ–ø–ª–æ—è
aws logs tail /aws/lambda/deploy-function --follow
```

### 2. S3 Access Logs

1. **–í–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–∞–∫–µ—Ç–∞
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–Ω–∞–ª–∏–∑** —á–µ—Ä–µ–∑ Athena

### 3. CloudFront Analytics

- **Usage Reports** –≤ CloudFront –∫–æ–Ω—Å–æ–ª–∏
- **Real-time metrics** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –°–∂–∞—Ç–∏–µ —Ñ–∞–π–ª–æ–≤

```javascript
// –í build-and-deploy.js
const gzip = require('gzip-js');
const fileContent = gzip.zip(fileContent, {level: 9});
```

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cache-Control –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
const cacheControl = {
  '*.html': 'public, max-age=3600',
  '*.css': 'public, max-age=31536000, immutable',
  '*.js': 'public, max-age=31536000, immutable'
};
```

### 3. CDN –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **Edge Locations:** –≤—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–µ –∫ –∞—É–¥–∏—Ç–æ—Ä–∏–∏
- **Compression:** –≤–∫–ª—é—á–∏—Ç–µ —Å–∂–∞—Ç–∏–µ
- **Security Headers:** –¥–æ–±–∞–≤—å—Ç–µ CSP, HSTS

## –°—Ç–æ–∏–º–æ—Å—Ç—å

### S3 Storage
- **–ü–µ—Ä–≤—ã–µ 50 TB:** $0.023 –∑–∞ GB/–º–µ—Å—è—Ü
- **–¢–∏–ø–∏—á–Ω—ã–π –±–ª–æ–≥:** ~100MB = $0.002/–º–µ—Å—è—Ü

### S3 Requests
- **GET requests:** $0.0004 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
- **PUT requests:** $0.0005 –∑–∞ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤

### CloudFront (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Data Transfer:** $0.085 –∑–∞ GB
- **Requests:** $0.0075 –∑–∞ 10000 –∑–∞–ø—Ä–æ—Å–æ–≤

### –ò—Ç–æ–≥–æ
- **–¢–æ–ª—å–∫–æ S3:** ~$1-3/–º–µ—Å—è—Ü
- **S3 + CloudFront:** ~$3-10/–º–µ—Å—è—Ü

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### 1. –û—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
aws s3 ls s3://your-bucket-name

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤
aws s3api put-bucket-policy --bucket your-bucket-name --policy file://policy.json
```

### 2. –û—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏

```bash
# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
rm -rf dist node_modules/.cache

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm ci
```

### 3. –ü—Ä–æ–±–ª–µ–º—ã —Å CloudFront

```bash
# –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
aws cloudfront create-invalidation --distribution-id YOUR_ID --paths "/*"
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

### 1. Netlify
- **–ü–ª—é—Å—ã:** –ø—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
- **–ú–∏–Ω—É—Å—ã:** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º –ø–ª–∞–Ω–µ

### 2. Vercel
- **–ü–ª—é—Å—ã:** –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
- **–ú–∏–Ω—É—Å—ã:** –¥–æ—Ä–æ–∂–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

### 3. GitHub Pages
- **–ü–ª—é—Å—ã:** –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Git
- **–ú–∏–Ω—É—Å—ã:** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

S3 + CloudFront - –æ—Ç–ª–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤:
- ‚úÖ –ù–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
- ‚úÖ –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–î–ª—è –±–ª–æ–≥–∞ —Å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä! 